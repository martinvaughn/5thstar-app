<%- include('../includes/loggedHeadNav.ejs') %>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js"></script>
<link rel="stylesheet" href="stylesheets/table.css">

</head>
    <div class="dashboard">     
        <div class="accordion">
            <button type="button" class="accordion__button"><h1>Upload Customers</h1></button>
            <div class="accordion__content">
                <div class="upload-wrapper">
                    <input id="chartFile" type="file" name="chartFile" accept=".csv"/>
                    <input id= "token" type="hidden" name="_csrf" value="<%= csrfToken %>"/>
                    <button id="chart-upload">Upload</button>
                    <p id="success-p" style="display: none;">&check; Uploaded successfully</p>
                    <div id="loader"></div>
                </div>
                
                <table class="past-uploads-table" id="uploads-table">
                    <thead>
                        <tr id="table-row">
                            <th>Purchases</th>
                            <th>File Name</th>
                            <th>Status</th>
                            <th>Date Uploaded</th>
                        </tr>    
                    </thead>
                    <tbody>
                        <% uploads.forEach(upload => { %>
                        <tr>
                            <td><%= upload.purchases %></td>
                            <td><%= upload.fileName %></td>
                            <td><%= upload.status %></td>
                            <td><%= upload.dateUploaded %></td>
                        </tr>
                        <% }); %>
                    </tbody>                  
                </table>
            </div>
        </div>
        <div class="analytics-container laptop">
            <div class="sent box">
                <div class="text">
                    <h1>Sent &nbsp;&nbsp;<%= analytics.sent %></h1>
                </div>
            </div>
            <div class="opened box">
                <div class="text">
                    <h1>Opened &nbsp;<%= (analytics.opened / analytics.sent) * 100 %>%</h1>
                    <span>Total Opened: <%= analytics.opened %></span>
                </div>
            </div>
            <div class="clicked box">
                <div class="text">
                    <h1>Clicked &nbsp;&nbsp;<%= (analytics.clicked / analytics.sent) * 100 %>%</h1>
                    <span>Total Clicked: <%= analytics.clicked %></span>
                </div>
            </div>
        </div>
        <div class="analytics-container mobile">
            <div class="sent box">
                <div class="text">
                    <h1>Sent &nbsp;&nbsp;<%= analytics.sent %></h1>
                </div>
            </div>
            <div class="analytics-lower-wrapper">
                <div class="opened box">
                    <div class="text">
                        <h1>Opened &nbsp;<%= (analytics.opened / analytics.sent) * 100 %>%</h1>
                        <span>Total Opened: <%= analytics.opened %></span>
                    </div>
                </div>
                <div class="clicked box">
                    <div class="text">
                        <h1>Clicked &nbsp;&nbsp;<%= (analytics.clicked / analytics.sent) * 100 %>%</h1>
                        <span>Total Clicked: <%= analytics.clicked %></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="scores-container">
            <div class="detractors box">
                <div class="text">
                    <h1>Negative</h1>
                    <span>Ratings 1-6</span>
                </div>
                <div class="score">
                    <h2><%= scores.negative %></h2>
                </div>
            </div>
            <div class="passives box">
                <div class="text">
                    <h1>Neutral</h1>
                    <span>Ratings 7-8</span>
                </div>
                <div class="score">
                    <h2><%= scores.neutral %></h2>
                </div>
            </div> 
            <div class="promoters box">
                <div class="text">
                    <h1>Positive</h1>
                    <span>Ratings 9-10</span>
                </div>
                <div class="score">
                    <h2><%= scores.positive %></h2>
                </div>
            </div>
            <div class="total-ratings box">
                <div class="text">
                    <h1>Total Ratings</h1>
                </div>
                <div class="score">
                    <h2><%= scores.totalRatings %></h2>
                </div>
            </div>
        </div>
    </div>
    <script src="scripts/uploadsTableScripts.js"></script>
    <script src="scripts/dashboardScripts.js"></script>
</div>
<%- include('../includes/foot.ejs') %>