<%- include('../includes/loggedHeadNav.ejs') %>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js"></script>
<link rel="stylesheet" href="stylesheets/table.css">

</head>
    <div class="dashboard">      
        <div class="accordion">
            <button type="button" class="accordion__button"><h1>Upload Customers</h1></button>
            <div class="accordion__content">
                <div class="upload-wrapper">
                    <input id="chart-file" type="file" name="chart-file" accept=".csv"/>
                    <input id= "token" type="hidden" name="_csrf" value="<%= csrfToken %>"/>
                    <button id="chart-upload" disabled>Upload</button>
                    <p id="success-p" style="display: none;">&check; Uploaded successfully</p>
                    <div id="loader"></div>
                </div>
                
                <table class="past-uploads-table" id="uploads-table">
                    <thead>
                        <tr id="table-row">
                            <th>Purchases</th>
                            <th>File Name</th>
                            <th>Status</th>
                            <th>Date Uploaded</th>
                        </tr>    
                    </thead>
                    <tbody>
                        <% uploads.forEach(upload => { %>
                        <tr>
                            <td><%= upload.purchases %></td>
                            <td><%= upload.fileName %></td>
                            <td><%= upload.status %></td>
                            <td><%= upload.dateUploaded.toDateString() %></td>
                        </tr>
                        <% }); %>
                    </tbody>                  
                </table>
            </div>
        </div>
        <div class="buttons-container">
            <a href="/metrics"><button class="metrics-btn box">Metrics</button></a>
            <a href="/feedback"><button class="feedback-btn box">Feedback</button></a>
        </div>
        
    </div>
    <script src="scripts/uploadsTableScripts.js"></script>
    <script src="scripts/dashboardScripts.js"></script>
</div>
<%- include('../includes/foot.ejs') %>